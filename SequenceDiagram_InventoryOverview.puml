@startuml MiniMart Sequence Diagram - Display Inventory Overview

title MiniMart - Display Inventory Overview Sequence Diagram\n(Including All Submenu Options)

actor "Store Manager" as Manager
participant "MiniMart" as MiniMart
participant "Product" as Product
participant "Transaction" as Transaction
participant "ArrayList<Product>" as ProductList
participant "ArrayList<Transaction>" as TransactionList
participant "Scanner" as Scanner
participant "System.out" as Console
database "File System" as Files

== Display Inventory Overview ==
Manager -> MiniMart: select option (1) from main menu
activate MiniMart
MiniMart -> MiniMart: displayInventoryOverview()
activate MiniMart

loop while user doesn't select option 6
    MiniMart -> ProductList: isEmpty()
    ProductList --> MiniMart: false
    
    alt products exist
        MiniMart -> MiniMart: create copy of products list
        MiniMart -> MiniMart: sort by Product::getName
        loop for each product
            MiniMart -> Product: getName()
            Product --> MiniMart: name
        end
        
        MiniMart -> Console: print table header
        loop for each product
            MiniMart -> Product: displayProduct()
            activate Product
            Product -> Product: isLowStock()
            Product --> Product: boolean
            Product -> Console: printf(id, name, prices, stock, threshold, status)
            deactivate Product
        end
        
        == Check Low Stock Alerts ==
        MiniMart -> MiniMart: create lowStockProducts list
        loop for each product
            MiniMart -> Product: isLowStock()
            Product --> MiniMart: boolean
            alt product is low stock
                MiniMart -> MiniMart: add to lowStockProducts
            end
        end
        
        alt low stock products exist
            MiniMart -> Console: print "LOW STOCK ALERT"
            loop for each low stock product
                MiniMart -> Product: getName()
                Product --> MiniMart: name
                MiniMart -> Product: getId()
                Product --> MiniMart: id
                MiniMart -> Product: getStockQuantity()
                Product --> MiniMart: stock
                MiniMart -> Product: getLowStockThreshold()
                Product --> MiniMart: threshold
                MiniMart -> Console: print alert details
            end
        end
    else no products
        MiniMart -> Console: print "No products in catalog"
    end
    
    == Display Submenu ==
    MiniMart -> MiniMart: displayInventorySubMenu()
    MiniMart -> Console: print submenu options (1-6)
    MiniMart -> Scanner: nextLine()
    Scanner --> MiniMart: user choice
    
    alt choice == "1" (Add Product)
        == Add Product Flow ==
        MiniMart -> MiniMart: addProduct()
        activate MiniMart
        Manager -> MiniMart: enter product details
        MiniMart -> Scanner: nextLine() - name
        MiniMart -> Scanner: nextLine() - purchasePrice
        MiniMart -> Scanner: nextLine() - sellingPrice
        MiniMart -> Scanner: nextLine() - threshold
        MiniMart -> Product: new Product(name, purchasePrice, sellingPrice, 0, threshold)
        activate Product
        Product -> Product: assign id
        Product --> MiniMart: new Product
        deactivate Product
        MiniMart -> ProductList: add(newProduct)
        MiniMart -> MiniMart: saveProducts()
        MiniMart -> Files: write products to file
        MiniMart -> Console: print "Product added successfully"
        MiniMart -> Scanner: nextLine() - wait for Enter
        deactivate MiniMart
        
    else choice == "2" (Edit Product)
        == Edit Product Flow ==
        MiniMart -> MiniMart: editProduct()
        activate MiniMart
        Manager -> MiniMart: enter product ID
        MiniMart -> Scanner: nextLine() - productId
        MiniMart -> MiniMart: findProductById(productId)
        MiniMart --> MiniMart: Product found
        Manager -> MiniMart: enter new values (or press Enter to keep)
        MiniMart -> Scanner: nextLine() - name
        MiniMart -> Scanner: nextLine() - purchasePrice
        MiniMart -> Scanner: nextLine() - sellingPrice
        MiniMart -> Scanner: nextLine() - stockQuantity
        MiniMart -> Scanner: nextLine() - threshold
        MiniMart -> Product: setName(name)
        MiniMart -> Product: setPurchasePrice(price)
        MiniMart -> Product: setSellingPrice(price)
        MiniMart -> Product: setStockQuantity(quantity)
        MiniMart -> Product: setLowStockThreshold(threshold)
        MiniMart -> MiniMart: saveProducts()
        MiniMart -> Files: write products to file
        MiniMart -> Console: print "Product updated successfully"
        MiniMart -> Scanner: nextLine() - wait for Enter
        deactivate MiniMart
        
    else choice == "3" (Delete Product)
        == Delete Product Flow ==
        MiniMart -> MiniMart: deleteProduct()
        activate MiniMart
        Manager -> MiniMart: enter product ID
        MiniMart -> Scanner: nextLine() - productId
        MiniMart -> MiniMart: findProductById(productId)
        MiniMart -> ProductList: remove(product)
        MiniMart -> MiniMart: saveProducts()
        MiniMart -> Files: write products to file
        MiniMart -> Console: print "Product deleted successfully"
        MiniMart -> Scanner: nextLine() - wait for Enter
        deactivate MiniMart
        
    else choice == "4" (Record Purchase)
        == Record Purchase Flow ==
        MiniMart -> MiniMart: recordPurchase()
        activate MiniMart
        Manager -> MiniMart: enter product ID
        MiniMart -> Scanner: nextLine() - productId
        MiniMart -> MiniMart: findProductById(productId)
        MiniMart --> MiniMart: Product found
        Manager -> MiniMart: enter quantity
        MiniMart -> Scanner: nextLine() - quantity
        MiniMart -> Product: increaseStock(quantity)
        activate Product
        Product -> Product: stockQuantity += quantity
        Product --> MiniMart: stock updated
        deactivate Product
        MiniMart -> Transaction: new Transaction(PURCHASE, productId, name, quantity, purchasePrice)
        activate Transaction
        Transaction -> Transaction: assign transactionId
        Transaction --> MiniMart: new Transaction
        deactivate Transaction
        MiniMart -> TransactionList: add(purchase)
        MiniMart -> MiniMart: saveProducts()
        MiniMart -> MiniMart: saveTransactions()
        MiniMart -> Files: write products and transactions
        MiniMart -> Console: print "Purchase recorded successfully"
        MiniMart -> Scanner: nextLine() - wait for Enter
        deactivate MiniMart
        
    else choice == "5" (Record Sale)
        == Record Sale Flow ==
        MiniMart -> MiniMart: recordSale()
        activate MiniMart
        Manager -> MiniMart: enter product ID
        MiniMart -> Scanner: nextLine() - productId
        MiniMart -> MiniMart: findProductById(productId)
        MiniMart --> MiniMart: Product found
        Manager -> MiniMart: enter quantity
        MiniMart -> Scanner: nextLine() - quantity
        MiniMart -> Product: getStockQuantity()
        Product --> MiniMart: currentStock
        alt sufficient stock
            MiniMart -> Product: decreaseStock(quantity)
            activate Product
            Product -> Product: stockQuantity -= quantity
            Product --> MiniMart: true
            deactivate Product
            MiniMart -> MiniMart: calculate revenue and profit
            MiniMart -> Transaction: new Transaction(SALE, productId, name, quantity, sellingPrice)
            activate Transaction
            Transaction -> Transaction: assign transactionId
            Transaction --> MiniMart: new Transaction
            deactivate Transaction
            MiniMart -> TransactionList: add(sale)
            MiniMart -> MiniMart: saveProducts()
            MiniMart -> MiniMart: saveTransactions()
            MiniMart -> Files: write products and transactions
            MiniMart -> Console: print "Sale recorded successfully"
        else insufficient stock
            MiniMart -> Console: print "ERROR: Insufficient stock!"
        end
        MiniMart -> Scanner: nextLine() - wait for Enter
        deactivate MiniMart
        
    else choice == "6" (Back to Main Window)
        MiniMart -> MiniMart: return
        break
    else invalid choice
        MiniMart -> Console: print "Invalid choice"
        MiniMart -> Scanner: nextLine() - wait for Enter
    end
end

MiniMart --> Manager: return to main menu
deactivate MiniMart
deactivate MiniMart

@enduml
