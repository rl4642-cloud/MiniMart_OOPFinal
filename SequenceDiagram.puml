@startuml MiniMart Sequence Diagram

title MiniMart - Sequence Diagram\nSmall Supermarket Inventory and Sales Management System

actor "Store Manager" as Manager
participant "Main" as Main
participant "MiniMart" as MiniMart
participant "Product" as Product
participant "Transaction" as Transaction
database "File System" as Files

== Initialization ==
Manager -> Main: start application
Main -> MiniMart: new MiniMart()
activate MiniMart
MiniMart -> Files: load products.bin
Files --> MiniMart: products data
MiniMart -> Files: load transactions.bin
Files --> MiniMart: transactions data
MiniMart --> Main: initialization complete
deactivate MiniMart
Main -> MiniMart: run()

== Display Inventory Overview ==
Manager -> MiniMart: select "Display inventory overview"
activate MiniMart
MiniMart -> MiniMart: displayInventoryOverview()
MiniMart -> MiniMart: sort products by name
loop for each product
    MiniMart -> Product: displayProduct()
    Product --> MiniMart: product info
end
MiniMart -> MiniMart: check low stock alerts
MiniMart --> Manager: display inventory table + submenu
deactivate MiniMart

== Add Product ==
Manager -> MiniMart: select "Add product" (from submenu)
activate MiniMart
Manager -> MiniMart: enter product details
MiniMart -> Product: new Product(name, purchasePrice, sellingPrice, stock, threshold)
activate Product
Product -> Product: assign ID (nextId++)
Product --> MiniMart: new Product instance
deactivate Product
MiniMart -> MiniMart: products.add(newProduct)
MiniMart -> Files: saveProducts()
Files --> MiniMart: saved
MiniMart --> Manager: "Product added successfully"
deactivate MiniMart

== Record Purchase (Restocking) ==
Manager -> MiniMart: select "Record purchase" (from submenu)
activate MiniMart
MiniMart -> MiniMart: displayAllProducts()
loop for each product
    MiniMart -> Product: displayProduct()
    Product --> MiniMart: product info
end
Manager -> MiniMart: enter product ID and quantity
MiniMart -> MiniMart: findProductById(id)
MiniMart -> Product: increaseStock(quantity)
activate Product
Product -> Product: stockQuantity += quantity
Product --> MiniMart: stock updated
deactivate Product
MiniMart -> Transaction: new Transaction(PURCHASE, productId, name, quantity, price)
activate Transaction
Transaction -> Transaction: assign transaction ID
Transaction -> Transaction: calculate totalAmount
Transaction -> Transaction: set timestamp
Transaction --> MiniMart: new Transaction instance
deactivate Transaction
MiniMart -> MiniMart: transactions.add(purchase)
MiniMart -> Files: saveProducts()
Files --> MiniMart: saved
MiniMart -> Files: saveTransactions()
Files --> MiniMart: saved
MiniMart --> Manager: "Purchase recorded successfully"
deactivate MiniMart

== Record Sale ==
Manager -> MiniMart: select "Record sale" (from submenu)
activate MiniMart
MiniMart -> MiniMart: displayAllProducts()
Manager -> MiniMart: enter product ID and quantity
MiniMart -> MiniMart: findProductById(id)
MiniMart -> Product: getStockQuantity()
Product --> MiniMart: current stock
alt sufficient stock
    MiniMart -> Product: decreaseStock(quantity)
    activate Product
    Product -> Product: stockQuantity -= quantity
    Product --> MiniMart: stock updated
    deactivate Product
    MiniMart -> MiniMart: calculate revenue and profit
    MiniMart -> Transaction: new Transaction(SALE, productId, name, quantity, price)
    activate Transaction
    Transaction -> Transaction: assign transaction ID
    Transaction -> Transaction: calculate totalAmount
    Transaction -> Transaction: set timestamp
    Transaction --> MiniMart: new Transaction instance
    deactivate Transaction
    MiniMart -> MiniMart: transactions.add(sale)
    MiniMart -> Files: saveProducts()
    Files --> MiniMart: saved
    MiniMart -> Files: saveTransactions()
    Files --> MiniMart: saved
    MiniMart --> Manager: "Sale recorded successfully"
else insufficient stock
    MiniMart --> Manager: "ERROR: Insufficient stock!"
end
deactivate MiniMart

== Display Total Profit Report ==
Manager -> MiniMart: select "Display total profit report"
activate MiniMart
MiniMart -> MiniMart: displayTotalProfit()
MiniMart -> MiniMart: initialize totalProfit = 0
loop for each transaction
    MiniMart -> Transaction: getType()
    Transaction --> MiniMart: transaction type
    alt transaction is SALE
        MiniMart -> Transaction: getProductId()
        Transaction --> MiniMart: product ID
        MiniMart -> MiniMart: findProductById(productId)
        MiniMart -> Product: getPurchasePrice()
        Product --> MiniMart: purchase price
        MiniMart -> Transaction: getQuantity()
        Transaction --> MiniMart: quantity
        MiniMart -> Transaction: getUnitPrice()
        Transaction --> MiniMart: selling price
        MiniMart -> MiniMart: calculate profit = (sellingPrice - purchasePrice) Ã— quantity
        MiniMart -> MiniMart: totalProfit += profit
    end
end
MiniMart -> MiniMart: display profit report
MiniMart --> Manager: total profit report
deactivate MiniMart

== Edit Product ==
Manager -> MiniMart: select "Edit product" (from submenu)
activate MiniMart
MiniMart -> MiniMart: displayAllProducts()
Manager -> MiniMart: enter product ID
MiniMart -> MiniMart: findProductById(id)
Manager -> MiniMart: enter new values
MiniMart -> Product: setName(name)
MiniMart -> Product: setPurchasePrice(price)
MiniMart -> Product: setSellingPrice(price)
MiniMart -> Product: setStockQuantity(quantity)
MiniMart -> Product: setLowStockThreshold(threshold)
MiniMart -> Files: saveProducts()
Files --> MiniMart: saved
MiniMart --> Manager: "Product updated successfully"
deactivate MiniMart

== Delete Product ==
Manager -> MiniMart: select "Delete product" (from submenu)
activate MiniMart
MiniMart -> MiniMart: displayAllProducts()
Manager -> MiniMart: enter product ID
MiniMart -> MiniMart: findProductById(id)
MiniMart -> MiniMart: products.remove(product)
MiniMart -> Files: saveProducts()
Files --> MiniMart: saved
MiniMart --> Manager: "Product deleted successfully"
deactivate MiniMart

@enduml

